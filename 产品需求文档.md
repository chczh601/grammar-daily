# 英语语法每日一练 - 产品需求文档 (PRD)

## 4.1 产品定位
一款轻量级的英语语法学习工具。既是用户的「每日语法练习场」，也是英语学习者的「语法知识库和学习助手」。

## 4.2 核心功能流程 (User Flow)

### 1. 每日练习 (Daily Practice)
- **核心逻辑**: 用户进入首页 -> 点击「开始练习」-> 依次完成10道语法题目（单选/填空/改错）-> 提交答案 -> 查看详细解析和得分 -> 选择是否收藏错题 -> 完成当日打卡
- **交互设计**: 题目自动切换，答题后即时反馈正确与否，提供详细考点解析
- **数据处理**: 记录用户答题数据，更新学习进度和正确率统计

### 2. 学习报告查看 (Learning Report)
- **核心逻辑**: 用户进入「学习报告」页面 -> 查看今日练习统计（完成题目数、正确率、用时）-> 查看本周学习趋势图 -> 查看薄弱知识点分析 -> 查看打卡记录
- **数据可视化**: 使用图表展示学习进度和正确率趋势，直观呈现学习成果
- **个性化推荐**: 根据薄弱知识点，推荐相关语法模块的学习和练习

### 3. 语法知识库学习 (Grammar Knowledge Base)
- **核心逻辑**: 用户进入「语法知识」页面 -> 选择语法模块（时态/从句/非谓语动词/虚拟语气/主谓一致）-> 查看模块下的语法知识点 -> 阅读语法规则说明和示例句子 -> 点击「相关练习」跳转至对应练习
- **内容组织**: 语法知识点分类清晰，支持折叠/展开查看详细内容
- **学习路径**: 提供结构化的语法学习路径，帮助用户系统学习

### 4. 错题本复习 (Wrong Answer Collection)
- **核心逻辑**: 用户进入「错题本」页面 -> 查看所有收藏的错题 -> 选择单题或批量练习 -> 重新答题 -> 查看解析 -> 选择是否移除错题
- **筛选功能**: 支持按语法模块、题型、时间等维度筛选错题
- **复习策略**: 智能推荐高频错题，帮助用户针对性复习

### 5. 用户认证与数据管理 (User Authentication)
- **核心逻辑**: 新用户进入小程序 -> 点击「我的」-> 选择「登录」-> 输入手机号/邮箱获取验证码 -> 完成登录 -> 查看个人信息和学习数据
- **数据隔离**: 确保每个用户只能访问自己的学习记录和数据
- **登录状态管理**: 优化登录体验，减少重复登录次数，保持登录状态持久化

### 6. 打卡激励机制 (Check-in Incentive)
- **核心逻辑**: 用户完成每日练习后 -> 自动弹出打卡成功提示 -> 查看连续打卡天数 -> 解锁打卡成就
- **激励设计**: 设置连续打卡奖励机制，提升用户学习积极性和粘性
- **进度展示**: 清晰展示连续打卡天数和距离下一个奖励的进度

## 4.3 功能模块详细设计

### 1. 每日练习模块
- **题目生成**: 系统每日自动生成10道题目，覆盖不同语法模块和难度
- **题型支持**: 单选题、填空题、改错题三种题型
- **答题反馈**: 即时反馈答题结果，提供详细解析和考点说明
- **进度保存**: 支持练习中途退出，下次继续练习

### 2. 学习报告模块
- **今日统计**: 完成题目数、正确率、用时、得分
- **本周趋势**: 每日正确率变化趋势图
- **薄弱知识点**: 基于答题数据分析的薄弱语法知识点
- **学习时长**: 每日学习时长统计
- **打卡记录**: 连续打卡天数和历史打卡记录

### 3. 语法知识库模块
- **模块分类**: 时态、从句、非谓语动词、虚拟语气、主谓一致五大模块
- **知识点详情**: 语法规则说明、示例句子、注意事项
- **相关练习**: 每个知识点关联的练习题
- **收藏功能**: 支持收藏常用语法知识点

### 4. 错题本模块
- **错题列表**: 按时间倒序展示所有收藏的错题
- **练习功能**: 支持单题练习和批量练习
- **筛选功能**: 按语法模块、题型、时间筛选
- **移除功能**: 支持移除已掌握的错题

### 5. 用户中心模块
- **个人信息**: 头像、昵称、手机号/邮箱
- **学习数据概览**: 总练习题目数、正确率、学习天数
- **功能入口**: 错题本、学习报告、设置
- **登录/退出**: 登录状态管理

## 4.4 技术实现要点

### 1. 前端实现
- **框架**: Taro + React + TypeScript
- **样式**: Tailwind CSS
- **组件**: 自定义答题卡片、学习报告图表、语法知识卡片等组件
- **状态管理**: React Hooks
- **导航**: 微信小程序导航栏和底部TabBar

### 2. 后端实现
- **数据库**: Supabase PostgreSQL
- **认证**: Supabase Auth
- **API**: RESTful API
- **数据处理**: 云函数处理复杂业务逻辑

### 3. 数据结构
- **语法模块表**: 存储语法模块信息
- **题目表**: 存储题目、选项、答案、解析等信息
- **用户记录表**: 存储用户答题记录、学习进度等
- **每日练习表**: 存储每日练习配置
- **打卡记录表**: 存储用户打卡记录

## 4.5 用户体验优化

### 1. 导航优化
- **二级页面返回**: 确保二级页面有清晰的返回按钮
- **底部导航**: 清晰的TabBar导航，方便用户在不同功能模块间切换
- **页面跳转**: 流畅的页面跳转动画，提升用户体验

### 2. 登录体验优化
- **减少重复登录**: 优化登录状态管理，减少重复登录次数
- **验证码优化**: 合理设置验证码有效期，提升登录便捷性
- **错误提示**: 清晰的错误提示，帮助用户解决登录问题

### 3. 答题体验优化
- **题目展示**: 清晰的题目和选项展示
- **答题反馈**: 即时的答题反馈和详细的解析
- **进度提示**: 清晰的练习进度提示，帮助用户了解当前练习情况

## 4.6 数据统计与分析

### 1. 用户数据统计
- **用户增长**: 新增用户数、活跃用户数
- **用户留存**: 次日留存、7日留存、30日留存
- **学习行为**: 每日练习完成率、平均练习时长、错题率

### 2. 内容数据统计
- **题目使用率**: 各题目的使用频率和正确率
- **模块热度**: 各语法模块的学习和练习热度
- **知识点掌握**: 各知识点的平均正确率

## 4.7 版本规划

### V1.0 核心功能版本
- 每日练习功能
- 语法知识库
- 用户认证
- 学习报告
- 基础UI界面

### V1.1 功能优化版本
- 错题本功能
- 打卡激励机制
- 学习数据可视化
- 用户体验优化

### V1.2 内容扩展版本
- 题库扩充
- 更多语法模块
- 个性化推荐
- 社交分享功能

## 4.8 风险评估与应对策略

### 1. 内容质量风险
- **风险**: 题目质量不高，解析不够准确
- **应对**: 建立严格的内容审核机制，邀请英语语法专家参与内容审核

### 2. 用户留存风险
- **风险**: 用户学习积极性下降，留存率低
- **应对**: 优化打卡激励机制，增加学习趣味性，提供个性化学习推荐

### 3. 技术风险
- **风险**: 小程序性能问题，数据加载缓慢
- **应对**: 优化代码，减少不必要的网络请求，使用缓存机制提升性能

### 4. 安全风险
- **风险**: 用户数据泄露，账号安全问题
- **应对**: 加强数据加密，使用安全的认证机制，定期进行安全审计

## 6. 开发经验总结

### 6.1 遇到的最大困难
在实现用户学习数据统计功能时，最初直接在前端计算和展示学习数据，导致数据统计不准确且性能较差。特别是在处理大量答题记录时，页面加载缓慢，用户体验不佳。此外，当多个用户同时使用时，还出现了数据竞争问题，导致统计结果不一致。

### 6.2 解决方案
我咨询了LLM，学习了**“后端数据处理与缓存”**的概念。将数据统计逻辑迁移到了后端，使用Supabase的数据库函数进行高效计算，然后将结果缓存起来。同时，为用户数据操作添加了适当的隔离机制，确保每个用户只能访问和统计自己的数据，解决了数据竞争问题。前端只需从后端获取处理好的统计结果，显著提升了页面加载速度和用户体验。

### 6.3 创新点
集成了**“智能语法知识点推荐”**功能。基于用户的答题记录和学习报告，系统会智能分析用户的薄弱语法知识点，然后在语法知识库中推荐相关的学习内容和针对性练习。当用户完成薄弱知识点的学习后，系统还会推送相应的巩固练习，帮助用户系统性地提高语法水平，极大提升了学习效率和用户体验。